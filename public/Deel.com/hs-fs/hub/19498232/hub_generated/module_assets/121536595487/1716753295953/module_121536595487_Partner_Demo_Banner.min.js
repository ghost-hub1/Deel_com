var module_121536595487=function(){window.addEventListener("message",(function(event){if("hsFormCallback"===event.data.type&&"onFormReady"===event.data.eventName){$('input[name="firstname"]').attr("placeholder","First Name").change(),$('input[name="lastname"]').attr("placeholder","Last Name").change(),$('select[name="headquarters"] option:disabled').text("Headquarters").change(),$('input[name="email"]').attr("placeholder","Work Email").change(),$('input[name="0-2/domain"]').attr("placeholder","Company Website").change(),$('input[name="phone"]').attr("placeholder","Phone number").change(),$('select[name="how_many_people_work_at_your_company_"] option:disabled').text("How many people work at your company?").change();var $hs_partner_id=document.querySelector(".partner-id__wrapper");if($hs_partner_id){var partnerId=$hs_partner_id.getAttribute("data-partner-id"),$partnerIdInput=document.querySelector('input[name="partner_id"]');$partnerIdInput&&($partnerIdInput.value=partnerId?atob(partnerId):"")}}}));const url=window.location.href;if(url.includes("partners")){let param=url.split("/partners")[1].substring(1);param.includes("?")&&(param=param.substr(0,param.indexOf("?"))),window.localStorage.setItem("partner",param)}function getCookieValue(cname){for(var name=cname+"=",ca=decodeURIComponent(document.cookie).split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""}function getCookie(name){const parts=`; ${document.cookie}`.split(`; ${name}=`);if(2===parts.length)return parts.pop().split(";").shift()}function getForm(){return document.getElementsByTagName("form")[0]}function getInput(name){return document.querySelector(`input[name="${name}"]`)}function getSelect(name){return document.querySelector(`select[name="${name}"]`)}function getEmailInput(){return document.querySelector('input[name="email"]')}function getFormFields(){const firstName=getInput("firstname"),lastName=getInput("lastname"),email=getInput("email"),website=getInput("0-2/domain"),phone=getInput("phone"),country=getSelect("headquarters");return{"First Name":firstName,"Last Name":lastName,"Company-Website":website,"Phone-Number":phone,"Company size":getSelect("how_many_people_work_at_your_company_"),Country:country,"Work email":email,cq_request_id:document.querySelector("div.form-container span div form input[name=cq_request_id]")}}async function toSHA256(text){try{const msgUint8=(new TextEncoder).encode(text),hashBuffer=await crypto.subtle.digest("SHA-256",msgUint8),hashArray=Array.from(new Uint8Array(hashBuffer));return hashArray.map((b=>b.toString(16).padStart(2,"0"))).join("")}catch(error){console.log("error in hash email"),console.error(error)}}function createError(message){const element=document.createElement("p");return element.setAttribute("style",'font-family: "Silka"; color: red; font-size: 12px; margin-top: 8px; margin-bottom: 0px; padding-left: 8px'),element.classList.add("form-error"),element.innerHTML=message,element}function clearFormErrors(){const errors=[...document.querySelectorAll(".form-error")];for(const error of errors)error.remove()}function sendDataLayerError(payload){if(window.sendDataLayerEvent)return window.sendDataLayerEvent({eventCategory:"Click",eventProduct:"Request a demo",eventAction:"Error",payload:payload}),!1}function getQueryParam(queryParam){return new Proxy(new URLSearchParams(window.location.search),{get:(searchParams,prop)=>searchParams.get(prop)})[queryParam]}async function createPartner(email,name){const customer_key=email,partner_key=function(){const gspk=getQueryParam("gspk");if(gspk)return decodeURIComponent(atob(gspk))}(),xid=getQueryParam("gsxid");if(partner_key&&xid)try{const body={name:name,email:email,origin:window.location.host,xid:xid,partner_code:partner_key,customer_code:customer_key};console.log(body);const res=await async function(body){return await axios.post("https://api-prod.letsdeel.com/partnerstack",body)}(body);console.log(res)}catch(error){console.log(error),console.log("error creating customer in ps")}}async function buildDataLayerPayload(){const{first_name:first_name,last_name:last_name,country:country,work_email:work_email,company_website:company_website,phone_number:phone_number,company_size:company_size}={first_name:getInput("firstname"),last_name:getInput("lastname"),country:getSelect("headquarters"),work_email:getInput("email"),company_website:getInput("0-2/company_website")||getInput("0-2/domain"),phone_number:getInput("phone")||getInput("phone"),company_size:getSelect("how_many_people_work_at_your_company_")},hashed_email=await toSHA256(work_email.value),hashed_phone=await toSHA256(phone_number.value);return{first_name:first_name.value,last_name:last_name.value,work_email:work_email.value,company_size:company_size.value,company_website:company_website.value,phone_number:phone_number.value,country:country.value,hashed_email:hashed_email,hashed_phone:hashed_phone}}$(".close-modal").click((function(){$("body").removeClass("show-modal-form")})),$((()=>{function validateWebsite(){const website=getInput("0-2/domain");if(website){const url=website.value;return 0===url.length?(website.parentElement.appendChild(createError("Please enter a website")),!1):(urlString=url,!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(urlString)||(website.parentElement.appendChild(createError("Please enter a valid url")),!1))}var urlString;return!1}async function validateEmail(){const emailInput=getEmailInput();if(emailInput){const email=emailInput.value;if(email||(emailInput.parentElement.appendChild(createError("Please enter a email")),sendDataLayerError({work_email:email,blocked_email:"Front End"})),!function(email){return/^([\w-\.]+@(?!mailinator.com)(?!gmail.com)(?!protonmail.com)(?!cloudmdrive.my.id)(?!icloud.com)(?!gmial.com)(?!gmali.com)(?!yahoo.com)(?!hotmail.com)(?!aol.com)(?!hotmail.co.uk)(?!gamil.com)(?!gmanil.com)(?!gmali.com)(?!hotmail.fr)(?!msn.com)(?!yahoo.fr)(?!wanadoo.fr)(?!orange.fr)(?!comcast.net)(?!yahoo.co.uk)(?!yahoo.com.br)(?!yahoo.co.in)(?!live.com)(?!rediffmail.com)(?!free.fr)(?!gmx.de)(?!web.de)(?!yandex.ru)(?!ymail.com)(?!libero.it)(?!outlook.com)(?!uol.com.br)(?!bol.com.br)(?!mail.ru)(?!cox.net)(?!hotmail.it)(?!sbcglobal.net)(?!sfr.fr)(?!live.fr)(?!verizon.net)(?!live.co.uk)(?!googlemail.com)(?!yahoo.es)(?!ig.com.br)(?!live.nl)(?!bigpond.com)(?!terra.com.br)(?!yahoo.it)(?!neuf.fr)(?!yahoo.de)(?!alice.it)(?!rocketmail.com)(?!att.net)(?!laposte.net)(?!facebook.com)(?!bellsouth.net)(?!yahoo.in)(?!hotmail.es)(?!charter.net)(?!yahoo.ca)(?!yahoo.com.au)(?!rambler.ru)(?!bozzcello.com)(?!bozztirex.us)(?!vivaldigital.com)(?!hotmail.de)(?!tiscali.it)(?!shaw.ca)(?!yahoo.co.jp)(?!sky.com)(?!earthlink.net)(?!optonline.net)(?!freenet.de)(?!t-online.de)(?!aliceadsl.fr)(?!virgilio.it)(?!home.nl)(?!qq.com)(?!telenet.be)(?!me.com)(?!yahoo.com.ar)(?!tiscali.co.uk)(?!yahoo.com.mx)(?!voila.fr)(?!gmx.net)(?!mail.com)(?!planet.nl)(?!tin.it)(?!live.it)(?!ntlworld.com)(?!arcor.de)(?!yahoo.co.id)(?!frontiernet.net)(?!hetnet.nl)(?!live.com.au)(?!yahoo.com.sg)(?!zonnet.nl)(?!club-internet.fr)(?!juno.com)(?!optusnet.com.au)(?!blueyonder.co.uk)(?!bluewin.ch)(?!skynet.be)(?!sympatico.ca)(?!windstream.net)(?!mac.com)(?!centurytel.net)(?!chello.nl)(?!live.ca)(?!aim.com)(?!work.nigga.com)(?!mytruecrimepodcast.com)(?!bigpond.net.au)([\w-]+\.)+[\w-]{2,12})?$/.test(email)}(email))return emailInput.parentElement.appendChild(createError("Please enter a valid work email")),sendDataLayerError({work_email:email,blocked_email:"Front End"}),!1;await async function(email){return await fetch("https://api-prod.letsdeel.com/hubspot/email-validation?email="+email)}(email);return!0}return!1}function validateField(field,error){return!!field&&(field.value.length>0||(field.parentElement.appendChild(createError(error)),!1))}async function validateForm(){const isWebsiteValid=validateWebsite(),isFirstNameValid=validateField(getInput("firstname"),"Please enter your first name"),isLastNameValid=validateField(getInput("lastname"),"Please enter your last name"),isCountryValid=validateField(getSelect("headquarters"),"Please select a country"),isPhoneValid=validateField(getInput("phone"),"Please enter your phone number"),isCompanySizeValid=validateField(getSelect("how_many_people_work_at_your_company_"),"Please select a company size");return await validateEmail()&&isWebsiteValid&&isFirstNameValid&&isLastNameValid&&isCountryValid&&isPhoneValid&&isCompanySizeValid}function addCustomFormValidations(){const form=getForm();if(form){const submitButton=document.querySelector('input[type="submit"]');submitButton&&submitButton.addEventListener("click",(async event=>{event.preventDefault(),clearFormErrors(),submitButton.value="Submitting...";if(await validateForm()){const emailInput=getEmailInput(),hashed_email=await toSHA256(emailInput?.value);!function(){const input=getInput("amp_session_id"),amp_session_id=getCookieValue("amp_session_id");null!==input&&amp_session_id&&(input.value=amp_session_id)}();const dl_payload=await buildDataLayerPayload();payload=dl_payload,window.sendDataLayerEvent&&window.sendDataLayerEvent({eventCategory:"Form",eventProduct:"Request a demo",eventAction:"Book a demo",payload:payload}),clearFormErrors();const body=function(formId,hashed_email){const partner=localStorage.getItem("partner"),fields=getFormFields();console.log(fields);const amp=getInput("amp_session_id"),hbFields=[{name:"form_id",value:formId},{name:"lead_source_detail",value:"Standard"},{name:"leadsource",value:"Inbound-Deel website"},{name:"0-2/partner",value:partner||""},{name:"firstname",value:fields["First Name"].value},{name:"lastname",value:fields["Last Name"].value},{name:"headquarters",value:fields.Country.value},{name:"email",value:fields["Work email"].value},{name:"0-2/domain",value:fields["Company-Website"].value},{name:"phone",value:fields["Phone-Number"].value},{name:"how_many_people_work_at_your_company_",value:fields["Company size"].value},{name:"amp_session_id",value:amp?amp.value:""},{name:"li_fat_id",value:getCookieValue("li_fat_id")||""},{name:"heap_user_id",value:getCookieValue("heap_user_id")||""},{name:"_fbc",value:getCookieValue("_fbc")||""},{name:"hashed_email",value:hashed_email||""}];return console.log(hbFields),hbFields}(form.getAttribute("data-form-id"),hashed_email),fields=getFormFields();await async function(body,fields){const url=`https://api.hsforms.com/submissions/v3/integration/submit/19498232/${document.querySelector("div.hero-form form input[name=form_id]").value}`,response=await fetch(url,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)}),json=await response.json();if("error"===json.status){for(const error of json.errors)error.message.includes("fields.email")&&fields["Work email"].parentElement.appendChild(createError("Work email")),error.message.includes("fields.0-2/domain")&&fields["Company-Website"].parentElement.appendChild(createError("Company website"));throw console.error(json.errors),new Error("Failed to submit form")}}({context:{hutk:getCookie("hubspotutk"),pageUri:window.location.href,pageName:"Request a Demo"},fields:body},fields);const email=getInput("email").value,firstname=getInput("firstname").value;await createPartner(email,firstname),form.submit(),await async function(){getInput("firstname");const company_website=getInput("0-2/domain")?.value,phone_number=getInput("phone")?.value,email=getInput("email")?.value,company_size=getSelect("how_many_people_work_at_your_company_")?.value,country=getSelect("headquarters")?.value,params={company_website:company_website,phone_number:phone_number,company_size:company_size,country:country,hashed_email:await toSHA256(email),work_email:email,hashed_phone_number:await phone_number};ChiliPiper.submit("letsdeel","inbound-router",{title:"Thanks! What time works best for a quick call?",onSuccess:async()=>{window.sendDataLayerEvent&&window.sendDataLayerEvent({eventCategory:"Submit",eventProduct:"Request a demo",eventAction:"Book a call",...params})},onClose:()=>{$(".close-modal").click((function(){$("body").removeClass("show-modal-form")}))}})}()}var payload;submitButton.value="Book a Demo"}))}}const searchForFormInterval=setInterval((()=>{getForm()&&function(){clearInterval(searchForFormInterval);const partner=getInput("0-2/partner");partner&&(partner.setAttribute("name","partner"),partner.setAttribute("value",window.localStorage.getItem("partner"))),addCustomFormValidations()}()}),100)}))}();